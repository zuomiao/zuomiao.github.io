(function(a){if(typeof module==="object"&&typeof module.exports==="object"){module.exports=a()}else{a(true)}})(function(n){var j=null,g=null,e=(function(){var q=document.createElement("div").style;var p=["t","webkitT","MozT","msT","OT"];var r="";for(var s=0,o=p.length;s<o;s++){r=p[s]+"ransform";if(r in q){return p[s]}}return""}());var m={CONTAINER_ID:"",MIN_CROSS:50,SCALE:true,ROTATE:true,SCALE_MIN:0.5,SCALE_MAX:3,AUTO_OPEN:true,TRAN_TIME:1,DATAS:[]};var l={WIN_WIDTH:0,WIN_HEIGHT:0,TRANSFORM:e==""?"transform":e+"ransform",TRANSITION:e==""?"transition":e+"ransition"};var h={ROOT:null,HEAD:null,WALL:null,IMG:null,FOOT:null};var i={OPEN_EVENT:null,CLOSE_EVENT:null,SWITCH_EVENT:null};var k={BAR_SHOW:true,ZOOM_LAST:1,ROTATE_LAST:0,X_LAST:0,Y_LAST:0,X_TMP:0,Y_TMP:0,CURRENT_INDEX:0};function a(o){m.CONTAINER_ID=typeof o.id!="undefined"?o.id:"";m.AUTO_OPEN=typeof o.auto_open!="undefined"?o.auto_open:m.AUTO_OPEN;m.SCALE=typeof o.scale!="undefined"?o.scale:m.SCALE;m.ROTATE=typeof o.rotate!="undefined"?o.rotate:m.ROTATE;m.DATAS=typeof o.data!="undefined"?o.data:m.DATAS;j.onOpen(o.evt_Open);j.onClose(o.evt_Close);j.onSwitch(o.evt_Switch);l.ORGIN_HEIGHT=document.documentElement.style.height;if(l.ORGIN_HEIGHT==""){document.documentElement.style.height="100%"}l.ORGIN_OVERFLOW=document.documentElement.style.overflow;l.ORGIN_OFFSET=[document.documentElement.scrollLeft,document.documentElement.scrollTop];l.WIN_HEIGHT=document.documentElement.offsetHeight;l.WIN_WIDTH=document.documentElement.offsetWidth;h.ROOT=document.getElementById(o.id)}function d(){var v=m.CONTAINER_ID+"_header",x=m.CONTAINER_ID+"_wall",o=m.CONTAINER_ID+"_footer";if(h.ROOT==null){h.ROOT=document.createElement("article");document.body.appendChild(h.ROOT)}var u='<section class="iw_header" id="'+v+'"><span class="iw_close" id="iw_close">&lt; 返回</span><span class="iw_title" id="iw_title"></span></section>';var t='<section class="iw_wall"><div id="'+x+'" class="iw_wall_ct"></div></section>';var p='<section class="iw_footer" id="'+o+'"></section>';h.ROOT.innerHTML=u+t+p;h.HEAD=document.getElementById(v);h.WALL=document.getElementById(x);h.FOOT=document.getElementById(o);h.ROOT.className+=" iw_container";h.ROOT.style.height=l.WIN_HEIGHT+"px";h.ROOT.style.width=l.WIN_WIDTH+"px";h.WALL.style.width=l.WIN_WIDTH*m.DATAS.length+"px";document.getElementById("iw_close").addEventListener("click",function(){j.close()});var w="";for(var s=0,q=m.DATAS.length;s<q;s++){var r=m.DATAS[s];w+='<div class="iw_img" style="width:'+l.WIN_WIDTH+'px;"><div id="iw_img_'+s+'"><div style="background-image:url('+r.imgUrl+');"></div></div> </div>'}h.WALL.innerHTML=w;h.IMG=document.getElementById("iw_img_0")}function f(){g=Hammer(h.WALL);var t=function(v){if(k.BAR_SHOW){h.HEAD.style.display="none";h.FOOT.style.display="none";k.BAR_SHOW=false}else{h.HEAD.style.display="block";h.FOOT.style.display="block";k.BAR_SHOW=true}};var s=function(v){if(k.ZOOM_LAST>1){k.X_TMP=k.X_LAST+v.deltaX;k.Y_TMP=k.Y_LAST+v.deltaY;j.transition()}else{j.slightMove(0-v.deltaX)}};var r=function(v){if(k.ZOOM_LAST>1){k.X_LAST=k.X_TMP;k.Y_LAST=k.Y_TMP}else{var w=k.CURRENT_INDEX;if(Math.abs(v.deltaX)<m.MIN_CROSS){}else{if(v.deltaX>0){w=k.CURRENT_INDEX-1}else{w=k.CURRENT_INDEX+1}}j.toIndex(w)}};g.on("tap",t);g.on("panmove",s);g.on("panend",r);var p=function(v){k.ZOOM_LAST*=Math.sqrt(Math.sqrt(Math.sqrt(v.scale)));k.ZOOM_LAST=k.ZOOM_LAST>m.SCALE_MIN?k.ZOOM_LAST:m.SCALE_MIN;k.ZOOM_LAST=k.ZOOM_LAST>m.SCALE_MAX?m.SCALE_MAX:k.ZOOM_LAST;k.ROTATE_LAST=m.ROTATE?v.rotation:0;j.transition()};var o=function(v){if(k.ZOOM_LAST<=1){k.ZOOM_LAST=1;k.ROTATE_LAST=0;k.X_LAST=k.X_TMP=0;k.Y_LAST=k.Y_TMP=0;j.restore()}};if(m.SCALE){var u=new Hammer.Pinch();if(m.ROTATE){var q=new Hammer.Rotate();u.recognizeWith(q);g.add([u,q])}else{g.add([u])}g.on("pinchmove",p);g.on("pinchend",o)}}function b(){d();f();if(m.AUTO_OPEN){j.open()}}var c=function(o){j=this;window.setTimeout(function(){a(o);b()},5)};c.prototype={setTranTime:function(p,o){p.style[l.TRANSITION]="all "+o+"s"},slightMove:function(o){this.setTranTime(h.WALL,0);h.WALL.style[l.TRANSFORM]="translate("+(0-(l.WIN_WIDTH*k.CURRENT_INDEX+o))+"px)"},toIndex:function(p){this.setTranTime(h.WALL,m.TRAN_TIME);p=p<0?0:p;p=p>=m.DATAS.length?m.DATAS.length-1:p;k.CURRENT_INDEX=p;h.IMG=document.getElementById("iw_img_"+k.CURRENT_INDEX);h.WALL.style[l.TRANSFORM]="translate("+(0-l.WIN_WIDTH*k.CURRENT_INDEX)+"px)";var o=h.IMG.style[l.TRANSFORM];k.ZOOM_LAST=/scale\(([\.\d]+)\)/.exec(o)?RegExp.$1:0;k.ROTATE_LAST=/rotate\(([\.\d]+)deg\)/.exec(o)?RegExp.$1:0;k.X_LAST=k.X_TMP=parseInt(/translateX\((\d+)px\)/.exec(o)?RegExp.$1:0);k.Y_LAST=k.Y_TMP=parseInt(/translateY\((\d+)px\)/.exec(o)?RegExp.$1:0);this.change()},transition:function(){this.setTranTime(h.IMG,0);this.setTranTime(h.IMG.firstChild,0);h.IMG.style[l.TRANSFORM]="scale("+k.ZOOM_LAST+") translateX("+k.X_TMP+"px) translateY("+k.Y_TMP+"px)";h.IMG.firstChild.style[l.TRANSFORM]="rotate("+k.ROTATE_LAST+"deg) "},restore:function(){this.setTranTime(h.IMG,m.TRAN_TIME);this.setTranTime(h.IMG.firstChild,m.TRAN_TIME);h.IMG.style[l.TRANSFORM]="scale("+k.ZOOM_LAST+") translateX("+k.X_TMP+"px) translateY("+k.Y_TMP+"px)";h.IMG.firstChild.style[l.TRANSFORM]="rotate("+k.ROTATE_LAST+"deg) "},change:function(){var o=m.DATAS[k.CURRENT_INDEX]["imgTitle"]||"";document.getElementById("iw_title").innerHTML=o;if(i.SWITCH_EVENT){i.SWITCH_EVENT.call(this,m.DATAS[k.CURRENT_INDEX])}},open:function(){window.scroll(0,0);document.documentElement.style.height=l.WIN_HEIGHT;document.documentElement.style.overflow="hidden";h.ROOT.style.display="block";if(i.OPEN_EVENT){window.setTimeout(i.OPEN_EVENT,3);this.change()}},close:function(){document.documentElement.style.height=l.ORGIN_HEIGHT;document.documentElement.style.overflow=l.ORGIN_OVERFLOW;window.scroll(l.ORGIN_OFFSET[0],l.ORGIN_OFFSET[1]);h.ROOT.style.display="none";if(i.CLOSE_EVENT){i.CLOSE_EVENT.call(this)}},onOpen:function(o){if(typeof o=="function"){i.OPEN_EVENT=o}},onClose:function(o){if(typeof o=="function"){i.CLOSE_EVENT=o}},onSwitch:function(o){if(typeof o=="function"){i.SWITCH_EVENT=o}},addAction:function(p,o){window.setTimeout(function(){var q=document.createElement("div");q.innerHTML=p;if(h.FOOT.children.length==0){q.className="iw_frist"}q.addEventListener("click",function(r){o.call(this,r,m.DATAS[k.CURRENT_INDEX])});h.FOOT.appendChild(q)},6)}};if(n){window.ImgWall=c}return c});